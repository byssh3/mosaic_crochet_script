function dcLoop() {
var spreadsheet = SpreadsheetApp.getActive();
var sheet = spreadsheet.getActiveSheet();
var range = sheet.getActiveRange();
var row = range.getRow();
var targetRow = sheet.getActiveRange().getRow();
var numberOfColumns = 1; //Manually define this on how many columns you have
var refRow = targetRow + 2;
var subRow = targetRow + 1;

for (var i = 1; i <= numberOfColumns; i++) {
var targetBkg = sheet.getRange(targetRow,i).getBackground();
var refBkg = sheet.getRange(refRow,i).getBackground();
var subBkg = sheet.getRange(subRow,i).getBackground();
if (row % 2 == 0 && refBkg == targetBkg && subBkg == targetBkg && refBkg == '#dbc9f0' || refBkg == '#facf22') {
sheet.getRange(targetRow,i).setValue("X");
}
else if (row % 2 != 0 && refBkg == targetBkg && subBkg == targetBkg && refBkg == '#fdfbff'){
sheet.getRange(targetRow,i).setValue("X");
		}
	}
}

function scooch(){
var spreadsheet = SpreadsheetApp.getActive();
var sheet = spreadsheet.getActiveSheet();
var current = sheet.getCurrentCell();
current.offset(-1,0).activateAsCurrentCell();
}

function looper(){
var numberOfRows = 1; //Manually define this on how many columns you have

for (var j = 1; j <= numberOfRows; j++){
dcLoop();
scooch();
	}
}

// The following is totally optional, but useful to make on the fly edits.
function onEdit(e) {

  var range = e.range;
  var bgColor = range.getBackground();
  var spreadSheet = e.source;
  var sheetName = spreadSheet.getActiveSheet().getName();
  var column = range.getColumn();
  var row = range.getRow();
  var inputValue = e.value;

  if([inputValue] == 'X' && row % 2 == 0)
  {
    SpreadsheetApp.getActiveSpreadsheet().getCurrentCell().setBackground('#dbc9f0');
    SpreadsheetApp.getActiveSpreadsheet().getCurrentCell().offset(1,0).setBackground('#dbc9f0').clearContent();
    SpreadsheetApp.getActiveSpreadsheet().getCurrentCell().offset(2,0).setBackground('#dbc9f0');
  }
  
  else if([inputValue] == 'X')
  {
    SpreadsheetApp.getActiveSpreadsheet().getCurrentCell().setBackground('#fdfbff');
    SpreadsheetApp.getActiveSpreadsheet().getCurrentCell().offset(1,0).setBackground('#fdfbff').clearContent();
    SpreadsheetApp.getActiveSpreadsheet().getCurrentCell().offset(2,0).setBackground('#fdfbff');
  }

  else if([inputValue] == '/')
  {
    SpreadsheetApp.getActiveSpreadsheet().getCurrentCell().clearContent();
  }

  else if([inputValue] == '.' && bgColor == '#fdfbff')
  {
    SpreadsheetApp.getActiveSpreadsheet().getCurrentCell().setBackground('#dbc9f0').clearContent();
  }

  else if([inputValue] == '.' && bgColor == '#dbc9f0')
  {
    SpreadsheetApp.getActiveSpreadsheet().getCurrentCell().setBackground('#fdfbff').clearContent();
  }
}
